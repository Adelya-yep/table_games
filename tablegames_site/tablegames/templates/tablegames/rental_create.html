{% extends 'tablegames/base.html' %}

{% block title %}–ê—Ä–µ–Ω–¥–∞ –∏–≥—Ä—ã - TableGames{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h4 class="card-title mb-0">üïí –ê—Ä–µ–Ω–¥–∞ –Ω–∞—Å—Ç–æ–ª—å–Ω–æ–π –∏–≥—Ä—ã</h4>
            </div>
            <div class="card-body">
                {% if not user.is_authenticated %}
                <div class="alert alert-warning">
                    –î–ª—è –∞—Ä–µ–Ω–¥—ã –∏–≥—Ä –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ <a href="{% url 'login' %}" class="alert-link">–≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</a>.
                </div>
                {% else %}
                
                {% if game %}
                <div class="alert alert-info">
                    –í—ã –∞—Ä–µ–Ω–¥—É–µ—Ç–µ: <strong>{{ game.name }}</strong>
                </div>
                {% endif %}
                
                <form method="post">
                    {% csrf_token %}
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.game.id_for_label }}" class="form-label">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É:</label>
                                {{ form.game }}
                                {% if form.game.errors %}
                                <div class="text-danger">{{ form.game.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.quantity.id_for_label }}" class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label>
                                {{ form.quantity }}
                                {% if form.quantity.errors %}
                                <div class="text-danger">{{ form.quantity.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.rental_start_date.id_for_label }}" class="form-label">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –∞—Ä–µ–Ω–¥—ã:</label>
                                {{ form.rental_start_date }}
                                {% if form.rental_start_date.errors %}
                                <div class="text-danger">{{ form.rental_start_date.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.rental_end_date.id_for_label }}" class="form-label">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞—Ä–µ–Ω–¥—ã:</label>
                                {{ form.rental_end_date }}
                                {% if form.rental_end_date.errors %}
                                <div class="text-danger">{{ form.rental_end_date.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    {% if form.non_field_errors %}
                    <div class="alert alert-danger">
                        {% for error in form.non_field_errors %}
                        {{ error }}
                        {% endfor %}
                    </div>
                    {% endif %}
                    
                    <div class="mt-4">
                        <button type="submit" class="btn btn-primary btn-lg w-100">
                            üïí –û—Ñ–æ—Ä–º–∏—Ç—å –∞—Ä–µ–Ω–¥—É
                        </button>
                    </div>
                </form>
                {% endif %}
            </div>
        </div>
        
        <div class="card mt-4">
            <div class="card-body">
                <h5>‚ÑπÔ∏è –£—Å–ª–æ–≤–∏—è –∞—Ä–µ–Ω–¥—ã</h5>
                <ul class="list-unstyled">
                    <li>‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å—Ä–æ–∫ –∞—Ä–µ–Ω–¥—ã: 1 –¥–µ–Ω—å</li>
                    <li>‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Å—Ä–æ–∫ –∞—Ä–µ–Ω–¥—ã: 30 –¥–Ω–µ–π</li>
                    <li>‚úÖ –ó–∞–ª–æ–≥ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è</li>
                    <li>‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–∏ –∞—Ä–µ–Ω–¥–µ –æ—Ç 3 –¥–Ω–µ–π</li>
                    <li>‚úÖ –í–æ–∑–≤—Ä–∞—Ç –≤–æ–∑–º–æ–∂–µ–Ω –¥–æ—Å—Ä–æ—á–Ω–æ</li>
                    <li>‚ùå –ü—Ä–∏ –ø–æ—Ä—á–µ –∏–≥—Ä—ã –≤–∑–∏–º–∞–µ—Ç—Å—è —à—Ç—Ä–∞—Ñ</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–∞—Ç—ã –æ–∫–æ–Ω—á–∞–Ω–∏—è
    const startDate = document.getElementById('{{ form.rental_start_date.id_for_label }}');
    const endDate = document.getElementById('{{ form.rental_end_date.id_for_label }}');
    
    startDate.addEventListener('change', function() {
        if (startDate.value && !endDate.value) {
            const start = new Date(startDate.value);
            start.setDate(start.getDate() + 1); // –¥–æ–±–∞–≤–ª—è–µ–º 1 –¥–µ–Ω—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            const endDateStr = start.toISOString().split('T')[0];
            endDate.value = endDateStr;
        }
    });
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∏–≥—Ä—ã
    const gameSelect = document.getElementById('{{ form.game.id_for_label }}');
    const quantityInput = document.getElementById('{{ form.quantity.id_for_label }}');
    
    gameSelect.addEventListener('change', function() {
        // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å AJAX –∑–∞–ø—Ä–æ—Å
        // –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∏–≥—Ä—ã
        quantityInput.value = 1;
    });
});
</script>
{% endblock %}